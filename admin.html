<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - √ìptica Nvision</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: Arial, sans-serif; 
            background: #1a1a1a; 
            color: white; 
            padding: 20px;
        }
        .container { max-width: 800px; margin: 0 auto; }
        .header { 
            background: #10b981; 
            padding: 20px; 
            border-radius: 10px; 
            text-align: center; 
            margin-bottom: 20px;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            font-weight: bold;
        }
        .btn-primary { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .section {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
        }
        .section.active { display: block; }
        .input {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #444;
            background: #333;
            color: white;
            border-radius: 5px;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .table th, .table td {
            padding: 10px;
            border-bottom: 1px solid #444;
            text-align: left;
        }
        .alert {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ADMIN √ìPTICA NVISION</h1>
            <p>Sistema de Gesti√≥n Simple</p>
        </div>

        <!-- MEN√ö PRINCIPAL -->
        <div id="menu">
            <button class="btn btn-primary" onclick="mostrar('inventario')">üì¶ INVENTARIO</button>
            <button class="btn btn-primary" onclick="mostrar('clientes')">üë• CLIENTES</button>
            <button class="btn btn-primary" onclick="mostrar('reportes')">üìä REPORTES</button>
            <button class="btn btn-danger" onclick="location.href='index.html'">üè† SALIR</button>
        </div>

        <!-- INVENTARIO -->
        <div id="inventario" class="section">
            <h2>üì¶ INVENTARIO</h2>
            <button class="btn btn-primary" onclick="mostrar('menu')">‚¨ÖÔ∏è Volver</button>
            
            <h3>Agregar Producto</h3>
            <input type="text" id="codigo" class="input" placeholder="C√≥digo">
            <input type="text" id="nombre" class="input" placeholder="Nombre">
            <input type="number" id="precio" class="input" placeholder="Precio">
            <input type="number" id="stock" class="input" placeholder="Stock">
            <button class="btn btn-primary" onclick="agregarProducto()">‚ûï Agregar</button>
            
            <h3>Lista de Productos</h3>
            <table class="table">
                <thead>
                    <tr>
                        <th>C√≥digo</th>
                        <th>Nombre</th>
                        <th>Precio</th>
                        <th>Stock</th>
                        <th>Acci√≥n</th>
                    </tr>
                </thead>
                <tbody id="tablaProductos"></tbody>
            </table>
        </div>

        <!-- CLIENTES -->
        <div id="clientes" class="section">
            <h2>üë• CLIENTES</h2>
            <button class="btn btn-primary" onclick="mostrar('menu')">‚¨ÖÔ∏è Volver</button>
            
            <h3>Agregar Cliente</h3>
            <input type="text" id="clienteNombre" class="input" placeholder="Nombre">
            <input type="tel" id="clienteTel" class="input" placeholder="Tel√©fono">
            <input type="email" id="clienteEmail" class="input" placeholder="Email">
            <button class="btn btn-primary" onclick="agregarCliente()">‚ûï Agregar</button>
            
            <h3>Lista de Clientes</h3>
            <table class="table">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Tel√©fono</th>
                        <th>Email</th>
                        <th>Acci√≥n</th>
                    </tr>
                </thead>
                <tbody id="tablaClientes"></tbody>
            </table>
        </div>

        <!-- REPORTES -->
        <div id="reportes" class="section">
            <h2>üìä REPORTES</h2>
            <button class="btn btn-primary" onclick="mostrar('menu')">‚¨ÖÔ∏è Volver</button>
            
            <div style="background: #333; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3>Resumen</h3>
                <p>Total Productos: <span id="totalProductos">0</span></p>
                <p>Total Clientes: <span id="totalClientes">0</span></p>
                <p>Productos con Stock Bajo: <span id="stockBajo">0</span></p>
            </div>
            
            <button class="btn btn-primary" onclick="exportarDatos()">üì• Exportar Datos</button>
            <button class="btn btn-primary" onclick="enviarReporteWhatsApp()">üì± Enviar por WhatsApp</button>
        </div>
    </div>

    <div class="alert" id="alert"></div>

    <script>
        // Base de datos simple
        let productos = JSON.parse(localStorage.getItem('nvisionProductos') || '[]');
        let clientes = JSON.parse(localStorage.getItem('nvisionClientes') || '[]');

        function mostrar(seccion) {
            document.querySelectorAll('.section, #menu').forEach(el => el.classList.remove('active'));
            if (seccion === 'menu') {
                document.getElementById('menu').classList.add('active');
            } else {
                document.getElementById(seccion).classList.add('active');
                if (seccion === 'inventario') cargarProductos();
                if (seccion === 'clientes') cargarClientes();
                if (seccion === 'reportes') cargarReportes();
            }
        }

        function showAlert(msg) {
            const alert = document.getElementById('alert');
            alert.textContent = msg;
            alert.style.display = 'block';
            setTimeout(() => alert.style.display = 'none', 3000);
        }

        // PRODUCTOS
        function agregarProducto() {
            const producto = {
                id: Date.now(),
                codigo: document.getElementById('codigo').value,
                nombre: document.getElementById('nombre').value,
                precio: document.getElementById('precio').value,
                stock: document.getElementById('stock').value
            };
            
            if (!producto.codigo || !producto.nombre) {
                showAlert('Complete los campos');
                return;
            }
            
            productos.push(producto);
            localStorage.setItem('nvisionProductos', JSON.stringify(productos));
            cargarProductos();
            
            document.getElementById('codigo').value = '';
            document.getElementById('nombre').value = '';
            document.getElementById('precio').value = '';
            document.getElementById('stock').value = '';
            
            showAlert('Producto agregado');
        }

        function cargarProductos() {
            const tabla = document.getElementById('tablaProductos');
            tabla.innerHTML = productos.map(p => `
                <tr>
                    <td>${p.codigo}</td>
                    <td>${p.nombre}</td>
                    <td>RD$ ${p.precio}</td>
                    <td>${p.stock}</td>
                    <td><button onclick="eliminarProducto(${p.id})">üóëÔ∏è</button></td>
                </tr>
            `).join('');
        }

        function eliminarProducto(id) {
            productos = productos.filter(p => p.id !== id);
            localStorage.setItem('nvisionProductos', JSON.stringify(productos));
            cargarProductos();
            showAlert('Producto eliminado');
        }

        // CLIENTES
        function agregarCliente() {
            const cliente = {
                id: Date.now(),
                nombre: document.getElementById('clienteNombre').value,
                telefono: document.getElementById('clienteTel').value,
                email: document.getElementById('clienteEmail').value
            };
            
            if (!cliente.nombre || !cliente.telefono) {
                showAlert('Complete nombre y tel√©fono');
                return;
            }
            
            clientes.push(cliente);
            localStorage.setItem('nvisionClientes', JSON.stringify(clientes));
            cargarClientes();
            
            document.getElementById('clienteNombre').value = '';
            document.getElementById('clienteTel').value = '';
            document.getElementById('clienteEmail').value = '';
            
            showAlert('Cliente agregado');
        }

        function cargarClientes() {
            const tabla = document.getElementById('tablaClientes');
            tabla.innerHTML = clientes.map(c => `
                <tr>
                    <td>${c.nombre}</td>
                    <td>${c.telefono}</td>
                    <td>${c.email || 'N/A'}</td>
                    <td>
                        <button onclick="contactarCliente('${c.telefono}', '${c.nombre}')">üì±</button>
                        <button onclick="eliminarCliente(${c.id})">üóëÔ∏è</button>
                    </td>
                </tr>
            `).join('');
        }

        function contactarCliente(tel, nombre) {
            const msg = `Hola ${nombre}! Soy de √ìptica Nvision. ¬øC√≥mo podemos ayudarte?`;
            window.open(`https://wa.me/${tel.replace(/\D/g, '')}?text=${encodeURIComponent(msg)}`, '_blank');
        }

        function eliminarCliente(id) {
            clientes = clientes.filter(c => c.id !== id);
            localStorage.setItem('nvisionClientes', JSON.stringify(clientes));
            cargarClientes();
            showAlert('Cliente eliminado');
        }

        // REPORTES
        function cargarReportes() {
            document.getElementById('totalProductos').textContent = productos.length;
            document.getElementById('totalClientes').textContent = clientes.length;
            document.getElementById('stockBajo').textContent = productos.filter(p => p.stock < 5).length;
        }

        function enviarReporteWhatsApp() {
            const mensaje = `üìä REPORTE √ìPTICA NVISION\n\n` +
                          `üì¶ Productos: ${productos.length}\n` +
                          `üë• Clientes: ${clientes.length}\n` +
                          `‚ö†Ô∏è Stock Bajo: ${productos.filter(p => p.stock < 5).length}\n\n` +
                          `üì± 849-797-2424`;
            
            window.open(`https://wa.me/18497972424?text=${encodeURIComponent(mensaje)}`, '_blank');
        }

        function exportarDatos() {
            const datos = { productos, clientes, fecha: new Date().toISOString() };
            const blob = new Blob([JSON.stringify(datos, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nvision_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            showAlert('Datos exportados');
        }

        // Inicializaci√≥n
        mostrar('menu');
    </script>
</body>
</html>
